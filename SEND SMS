<?php
function sendSMS($customer, $factorNumber, $factor, $uniqueId)
{
    $name = '';
    if (!empty($customer->displayName) || !empty($customer->family)) {
        $name = trim(($customer->displayName ?? '') . ' ' . ($customer->family ?? ''));
    }

    $phone = $customer->phone ?? '';
    $total = number_format($factor->totalPrice);
    $date = $factor->date;

    if ($name) {
        $message = "$name Ø¹Ø²ÛŒØ²ØŒ\n";
    } else {
        $message = "Ú©Ø§Ø±Ø¨Ø± Ú¯Ø±Ø§Ù…ÛŒØŒ\n";
    }

    $message .= "Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø¨Ø§ Ù…Ø¨Ù„Øº $total Ø±ÛŒØ§Ù„ Ø¯Ø± ØªØ§Ø±ÛŒØ® $date Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯.\n";
    $message .= "Ø´Ù…Ø§Ø±Ù‡ ÙØ§Ú©ØªÙˆØ± Ø´Ù…Ø§: $factorNumber\n";
    $message .= "Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ§Ú©ØªÙˆØ±: https://sells.yadak.shop/$uniqueId\n";
    $message .= "ÛŒØ¯Ú© Ø´Ø§Ù¾ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù…Ø§ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø± Ø§Ø³Øª Ùˆ Ø®ÙˆØ´Ø­Ø§Ù„ÛŒÙ… Ú©Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø´Ù…Ø§ Ù‡Ø³ØªÛŒÙ….\n";
    $message .= "Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¨ÛŒØ´ØªØ± Ø¨Ù‡ Ø³Ø§ÛŒØª Ù…Ø§ Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒØ¯:\n";
    $message .= "www.yadak.shop";


    $curl = curl_init();
    curl_setopt_array($curl, array(
        CURLOPT_URL => 'https://api.sms.ir/v1/send/bulk',
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_CUSTOMREQUEST => 'POST',
        CURLOPT_POSTFIELDS => json_encode([
            "lineNumber" => "90004752",
            "MessageText" => $message,
            "Mobiles" => [$phone]
        ]),
        CURLOPT_HTTPHEADER => array(
            'Content-Type: application/json',
            'Accept: text/plain',
            'x-api-key: ' . '****',
        ),
    ));
    $response = curl_exec($curl);
    curl_close($curl);

    return $response;
}
?>

---HTML JS 
<div id="smsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-lg w-96 p-6 text-right relative">

        <h2 class="text-xl font-bold mb-4 text-gray-700">Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…Ú©</h2>

        <form method="POST">
            <label class="block mb-2 text-sm font-medium text-gray-700">Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„:</label>
            <input type="text" name="phone" class="w-full border border-gray-300 rounded-lg p-2 mb-4 focus:ring-2 focus:ring-yellow-400 outline-none" placeholder="Ù…Ø«Ù„Ø§Ù‹ 09123456789" value="<?php echo htmlspecialchars($phone ?? ''); ?>">

            <label class="block mb-2 text-sm font-medium text-gray-700">Ù…ØªÙ† Ù¾ÛŒØ§Ù…:</label>
            <textarea id="messageInput" name="message" class="w-full border border-gray-300 rounded-lg p-2 mb-3 h-28 resize-none focus:ring-2 focus:ring-yellow-400 outline-none" placeholder="Ù…ØªÙ† Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"></textarea>

            <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ† Ø¢Ù…Ø§Ø¯Ù‡ -->
            <div class="flex flex-wrap gap-2 mb-4">
                <button type="button" onclick="setMessage('Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯. Ø§Ø² Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±ÛŒÙ… ğŸ™')" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded-lg text-sm">
                    Ù¾ÛŒØ§Ù… Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´
                </button>
                <button type="button" onclick="setMessage('Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ ğŸšš. Ø§Ø² Ù‡Ù…Ø±Ø§Ù‡ÛŒ Ø´Ù…Ø§ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±ÛŒÙ….')" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded-lg text-sm">
                    Ù¾ÛŒØ§Ù… Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´
                </button>
                <button type="button" onclick="setMessage('Ø¨Ø§ ØªØ´Ú©Ø± Ø§Ø² Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ ğŸŒŸ. Ù„Ø·ÙØ§Ù‹ Ù†Ø¸Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø§ Ù…Ø§ Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯.')" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded-lg text-sm">
                    Ù¾ÛŒØ§Ù… ØªØ´Ú©Ø±
                </button>
            </div>

            <div class="flex justify-between">
                <button type="submit" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition">
                    Ø§Ø±Ø³Ø§Ù„
                </button>
                <button type="button" onclick="closeModal()" class="px-4 py-2 border border-gray-400 rounded-lg hover:bg-gray-200 transition">
                    Ø¨Ø³ØªÙ†
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    const modal = document.getElementById('smsModal');
    const messageInput = document.getElementById('messageInput');

    function openModal() {
        modal.classList.remove('hidden');
    }

    function closeModal() {
        modal.classList.add('hidden');
    }

    function setMessage(text) {
        messageInput.value = text;
    }
    window.onclick = function(e) {
        if (e.target === modal) closeModal();
    }

</script>
